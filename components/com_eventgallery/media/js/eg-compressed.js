var SizeCalculator=new Class({Implements:[Options],options:{availableSizes:new Array(32,48,64,72,94,104,110,128,144,150,160,200,220,288,320,400,512,576,640,720,800,912,1024,1152,1280,1440)},getSize:function(c,a,b){var d=this.options.availableSizes[0];this.options.availableSizes.each(function(i,f){if(d>32){return}var h=f==this.options.availableSizes.length-1;if(b>=1){var e=i>c;var g=i/b>a;if((e&&g)||h){d=i}}else{var g=i>a;var e=i*b>c;if((e&&g)||h){d=i}}}.bind(this));return d},adjustImageURL:function(a,b){a=a.replace(/width=(\d*)/,"width="+b);a=a.replace(/\/s(\d*)\//,"/s"+b+"/");a=a.replace(/\/s(\d*)-c\//,"/s"+b+"-c/");return a}});var EventgalleryToolbox=new Class({calcBorderWidth:function(f,c){var d=0;for(var b=0;b<f.length;b++){for(var a=0;a<c.length;a++){var e=f[b].getStyle(c[a]).toInt();if(!isNaN(e)){d+=e}}}return d}});var EventgalleryImage=new Class({Extends:EventgalleryToolbox,Implements:[Options],options:{maxImageHeight:800},initialize:function(c,b,a){this.setOptions(a);this.tag=c;this.index=b;this.calcSize()},calcSize:function(){var b=this.tag.getElement("img");if(b==null){return}var a=[this.tag,b];this.glueLeft=this.calcBorderWidth(a,["padding-left","margin-left","border-width"]);this.glueRight=this.calcBorderWidth(a,["padding-right","margin-right","border-width"]);this.glueTop=this.calcBorderWidth(a,["padding-top","margin-top","border-width"]);this.glueBottom=this.calcBorderWidth(a,["padding-bottom","margin-bottom","border-width"]);this.width=b.getProperty("data-width").toInt();this.height=b.getProperty("data-height").toInt();if(this.width==null){this.width=this.tag.getSize().x-this.glueLeft-this.glueRight}if(this.height==null){this.height=this.tag.getSize().y-this.glueTop-this.glueBottom}},setSize:function(b,j){if(j>this.options.maxImageHeight){b=Math.round(b/j*this.options.maxImageHeight);j=this.options.maxImageHeight}var d=b-this.glueLeft-this.glueRight;var a=j-this.glueTop-this.glueBottom;if(this.width<d){d=this.width}if(this.height<a){a=this.height}var h=this.width/this.height;var e=new SizeCalculator();var f=e.getSize(d,a,h);var c=this.tag.getElement("img");if(c==null){return}var i=c.getStyle("background-image");var g=c.getAttribute("longDesc");if(!g){g=""}i=e.adjustImageURL(i,f);g=e.adjustImageURL(g,f);c.setStyle("background-image",i);c.set("longDesc",g);c.setStyle("background-position","50% 50%");c.setStyle("background-repeat","no-repeat");c.setStyle("display","block");c.setStyle("margin","auto");if(d>0){c.setStyle("width",d)}if(a>0){c.setStyle("height",a)}}});var EventgalleryRow=new Class({Implements:[Options],options:{maxWidth:960,maxHeight:150,heightJitter:0,adjustHeight:true,cropLastImage:true},initialize:function(a){this.setOptions(a);this.images=new Array();this.width=0;if(this.options.heightJitter>0){this.options.maxHeight=Math.floor(this.options.maxHeight+(Math.random()*2*this.options.heightJitter)-this.options.heightJitter)}},add:function(b){var a=Math.floor(b.width/b.height*this.options.maxHeight);if(this.width+a<=this.options.maxWidth||this.images.length==0){this.images.push(b);this.width=this.width+a;return true}else{return false}},processRow:function(b){var g=this.options.maxWidth-this.width;var c=Math.floor(g/this.images.length);if(c>this.options.rowWidth/this.images.length){c=0}var d=Math.floor(g/this.images.length);if(this.options.adjustHeight==false){d=0}if(d<0){d=0}var f=g-(c*(this.images.length-1));if((this.images.length==1&&!this.options.cropLastImage)||(b&&this.images.length==1&&this.images[0].height<this.images[0].width)){var e=this.images[0];var a=Math.round(e.height/e.width*this.options.maxWidth);e.setSize(this.options.maxWidth,a)}else{this.images.each(function(j,i){var h=Math.floor(j.width/j.height*this.options.maxHeight);if(i==this.images.length-1){j.setSize(h+f,this.options.maxHeight+d)}else{j.setSize(h+c,this.options.maxHeight+d)}}.bind(this))}}});var EventgalleryImagelist=new Class({Implements:[Options],options:{rowHeightPercentage:100,rowHeight:150,rowHeightJitter:0,minImageWidth:150,cropLastImage:true,imagesetContainer:null,imageset:null,firstImageRowHeight:2,initComplete:function(){},resizeStart:function(){},resizeComplete:function(){}},images:Array(),eventgalleryPageWidth:0,width:null,initialize:function(b){this.setOptions(b);this.width=this.options.imagesetContainer.getSize().x;var a=this.options.imageset;this.images=Array();a.each(function(d,c,e){this.images.push(new EventgalleryImage(d,c))}.bind(this));window.addEvent("resize",function(){window.clearTimeout(this.eventgalleryTimer);this.eventgalleryTimer=(function(){var c=this.options.imagesetContainer.getSize().x;this.width=c;if(this.eventgalleryPageWidth!=c){this.options.resizeStart();this.eventgalleryPageWidth=c;this.processList();this.options.resizeComplete()}}.bind(this)).delay(500)}.bind(this));this.options.imagesetContainer.setStyle("min-height",this.options.rowHeight*this.images.length);this.processList();this.options.imagesetContainer.setStyle("min-height","0px");this.options.initComplete()},getRowWidth:function(){var a=this.width;if(window.getComputedStyle){a=Math.floor(window.getComputedStyle(this.options.imagesetContainer).width.toFloat())-1}else{a=a-1}return a},processList:function(){var b=this.getRowWidth();var e=Array.clone(this.images);if(this.options.firstImageRowHeight>1){var f=e.shift();f.tag.setStyle("display","none");b=this.getRowWidth();f.tag.setStyle("display","block");var a=this.options.firstImageRowHeight*this.options.rowHeight;var c=Math.floor(f.width/f.height*a);if(c+this.options.minImageWidth>=b){c=b;rowsLeft=0}f.setSize(c,a);var d={maxWidth:b-c,maxHeight:this.options.rowHeight,adjustHeight:false};if(d.maxWidth>0){this.generateRows(e,this.options.firstImageRowHeight,d,false)}}var d={maxWidth:b,maxHeight:this.options.rowHeight,heightJitter:this.options.rowHeightJitter,cropLastImage:this.options.cropLastImage};this.generateRows(e,99999,d,true)},generateRows:function(e,f,c,a){var b=new EventgalleryRow(c);while(e.length>0&&f>0){var d=b.add(e[0]);if(d){e.shift()}else{b.processRow(a);f--;if(f==0){break}b=new EventgalleryRow(c)}}b.processRow(a)}});var EventgalleryEventsList=new Class({Extends:EventgalleryImagelist,Implements:[Options],processList:function(){var a=this.width;this.images.each(function(c){var b=Math.ceil(a*this.options.rowHeightPercentage/100);c.setSize(a,b)}.bind(this))}});var EventgalleryEventsTiles=new Class({Extends:EventgalleryImagelist,eventgalleryTilesCollection:null,processList:function(){var a=this.width;this.images.each(function(d){var b=Math.round(d.height/d.width*a);var c=a;if(this.options.adjustMode=="height"&&d.height>d.width){b=a;c=Math.round(d.width/d.height*b)}d.setSize(c,b)}.bind(this))}});var EventgalleryGridCollection=new Class({Extends:EventgalleryToolbox,Implements:[Options],options:{tilesSelector:"#events-tiles .event",tilesContainerSelector:"#events-tiles .event-tiles",thumbSelector:".event-thumbnail",thumbContainerSelector:".event-thumbnails"},tiles:null,tilesContainer:null,initialize:function(a){this.setOptions(a);this.tiles=$$(this.options.tilesSelector);this.tilesContainer=$$(this.options.tilesContainerSelector)},calculate:function(){var e=1;this.tiles.setStyles({visibility:"hidden",position:"static","float":"left"});var g=this.tiles[0].getPosition().y;for(var c=1;c<this.tiles.length;c++){if(this.tiles[c].getPosition().y!=g){break}e++}var d=this.tiles[0].getSize().x;var b=0;var a=0;this.tiles.each(function(h){h.setStyle("left",b*d);h.setStyle("top",a*d);h.setStyle("height",d);b++;if(b+1>e){b=0;a++}}.bind(this));this.tiles.each(function(l){var k=l.getElements(this.options.thumbSelector)[0];var o=l.getElements(this.options.thumbContainerSelector)[0];var m=l.getSize();var j=k.getSize();var n=m.x-this.calcBorderWidth([l],["padding-right","margin-right","border-width","padding-left","margin-left","border-width"]);var i=Math.floor((n-j.x)/2);var h=Math.floor((m.y-j.y)/2);o.setAttribute("data-adjust-x",i);o.setAttribute("data-adjust-y",h)}.bind(this));this.tiles.each(function(h){var i=h.getElements(this.options.thumbContainerSelector)[0];i.setStyle("left",i.getAttribute("data-adjust-x")+"px");i.setStyle("top",i.getAttribute("data-adjust-y")+"px")}.bind(this));var f=Math.ceil(this.tiles.length/e)*d;this.tilesContainer.setStyle("height",f);this.tiles.setStyles({visibility:"visible",position:"absolute","float":"none"})}});var EventgalleryTilesCollection=new Class({Implements:[Options],options:{tilesSelector:"#events-tiles .event",tilesContainerSelector:"#events-tiles .event-tiles"},tiles:null,tilesContainer:null,initialize:function(a){this.setOptions(a);this.tiles=$$(this.options.tilesSelector);this.tilesContainer=$$(this.options.tilesContainerSelector)},calculate:function(){var c=1;this.tiles.each(function(f){f.setStyle("visibility","hidden");f.setStyle("position","static");f.setStyle("float","left")});var e=this.tiles[0].getPosition().y;for(var a=1;a<this.tiles.length;a++){if(this.tiles[a].getPosition().y!=e){break}c++}var d=[];for(var a=0;a<c;a++){d.push(0)}var b=this.tiles[0].getSize().x;this.tiles.each(function(g){var f=this.getSmallestColumn(d);g.setStyle("left",f*b);g.setStyle("top",d[f]);d[f]=d[f]+g.getSize().y}.bind(this));this.tiles.each(function(f){f.setStyle("visibility","visible");f.setStyle("position","absolute");f.setStyle("float","none")});this.tilesContainer.setStyle("height",d[this.getHighestColumn(d)])},getSmallestColumn:function(d){var b=d[0];var c=0;for(var a=0;a<d.length;a++){if(b>d[a]){b=d[a];c=a}}return c},getHighestColumn:function(c){var d=c[0];var a=0;for(var b=0;b<c.length;b++){if(d<c[b]){d=c[b];a=b}}return a}});var EventgalleryCart=new Class({Implements:[Options],cart:new Array(),options:{buttonShowType:"block",emptyCartSelector:".eventgallery-cart-empty",cartSelector:".eventgallery-ajaxcart",cartItemContainerSelector:".cart-items-container",cartItemsSelector:".eventgallery-ajaxcart .cart-items",cartItemSelector:".eventgallery-ajaxcart .cart-items .cart-item",cartCountSelector:".itemscount",buttonDownSelector:".toggle-down",buttonUpSelector:".toggle-up",cartItemsMinHeight:null,removeUrl:"",add2cartUrl:"",getCartUrl:"",removeLinkTitle:"Remove"},initialize:function(a){this.setOptions(a);this.myVerticalSlide=new Fx.Tween($$(this.options.cartItemContainerSelector).getLast(),{duration:"short",transition:"quad:in",link:"cancel",property:"height"});$$(this.options.buttonDownSelector).addEvent("click",function(b){b.stop();this.myVerticalSlide.start($$(this.options.cartItemsSelector).getLast().getSize().y);$$(this.options.buttonDownSelector).setStyle("display","none");$$(this.options.buttonUpSelector).setStyle("display",this.options.buttonShowType)}.bind(this));$$(this.options.buttonUpSelector).addEvent("click",function(b){b.stop();this.myVerticalSlide.start(this.options.cartItemsMinHeight);$$(this.options.buttonUpSelector).setStyle("display","none");$$(this.options.buttonDownSelector).setStyle("display",this.options.buttonShowType)}.bind(this));$(document.body).removeEvents("click:relay(.eventgallery-add2cart)");$(document.body).addEvent("click:relay(.eventgallery-add2cart)",function(b){this.add2cart(b)}.bind(this));$(document.body).removeEvents("click:relay(.eventgallery-add-all)");$(document.body).addEvent("click:relay(.eventgallery-add-all)",function(b){this.addAll2cart(b)}.bind(this));$(document.body).removeEvents("click:relay(.eventgallery-removeFromCart)");$(document.body).addEvent("click:relay(.eventgallery-removeFromCart)",function(b){this.removeFromCart(b)}.bind(this));$(document.body).addEvent("updatecartlinks",function(b){this.populateCart(true)}.bind(this));$(document.body).addEvent("updatecart",function(b){this.cart=b.cart;this.populateCart(false)}.bind(this));this.updateCart()},updateCartItemContainer:function(){var b=false;var d=-1;$$(this.options.cartItemSelector).each(function(e){var f=e.getPosition().y;if(d<0){d=f}else{if(d!=f){b=true}}}.bind(this));if(b){var c=$$(this.options.buttonDownSelector);var a=$$(this.options.buttonUpSelector);if(c.getStyle("display")=="none"&&a.getStyle("display")=="none"){c.setStyle("display",this.options.buttonShowType)}else{if(a.getStyle("display")!="none"){setTimeout(function(){this.myVerticalSlide.stop();this.myVerticalSlide.start($$(this.options.cartItemsSelector).getLast().getSize().y)}.bind(this),1000)}}}else{this.myVerticalSlide.start(this.options.cartItemsMinHeight);$$(this.options.buttonUpSelector).setStyle("display","none");$$(this.options.buttonDownSelector).setStyle("display","none")}},populateCart:function(b){var a=new Fx.Slide($$(this.options.cartSelector)[0],{resetHeight:true});if(this.cart.length==0){a.slideOut();$$(this.options.emptyCartSelector).setStyle("display","block")}else{$$(this.options.cartSelector).setStyle("display","block");a.slideIn();$$(this.options.emptyCartSelector).setStyle("display","none")}var d=$$(this.options.cartItemsSelector).getLast();if(d==null){return}if(!b){d.set("html","")}$$("a.eventgallery-add2cart").addClass("button-add2cart").removeClass("button-alreadyInCart");for(var c=this.cart.length-1;c>=0;c--){var e="folder="+this.cart[c].folder+"&file="+this.cart[c].file;if(!b){d.set("html",d.get("html")+'<div class="cart-item"><span class="badge">'+this.cart[c].count+"</span>"+this.cart[c].imagetag+'<a href="#" title="'+this.options.removeLinkTitle+'" class="eventgallery-removeFromCart button-removeFromCart" data-id="lineitemid='+this.cart[c].lineitemid+'"><i class="big"></i></a></div>')}$$('a.eventgallery-add2cart[data-id="'+e+'"]').addClass("button-alreadyInCart").removeClass("button-add2cart")}if(!b){d.set("html",d.get("html")+'<div style="clear:both"></div>');if(null==this.options.cartItemsMinHeight){this.options.cartItemsMinHeight=$$(this.options.cartItemContainerSelector).getLast().getSize().y}this.updateCartItemContainer()}$$(".itemscount").set("html",this.cart.length);EventGalleryMediabox.scanPage()},updateCart:function(){var a=new Request.JSON({url:this.options.getCartUrl,method:"post",data:{json:"yes"},onComplete:function(b){if(b!==undefined){$(document.body).fireEvent("updatecart",{target:null,cart:b,stop:function(){},preventDefault:function(){},stopPropagation:function(){}})}}.bind(this)}).send()},removeFromCart:function(a){return this.doRequest(a,this.options.removeUrl)},add2cart:function(b){var a=$$("input:checked[name=currentimagetype]");if(a.length>0){if(b.target.tagName=="A"){linkElement=$(b.target)}else{linkElement=$(b.target).getParent("A")}var c=linkElement.getAttribute("data-id");c=c+"&imagetypeid="+a[0].value;return this.doRequest(b,this.options.add2cartUrl,c)}else{return this.doRequest(b,this.options.add2cartUrl)}},addAll2cart:function(c){var b=$$("input:checked[name=currentimagetype]");var a=[];$$(".eventgallery-add2cart").each(function(d){$(document.body).fireEvent("click:relay(.eventgallery-add2cart)",{target:d,stop:function(){},preventDefault:function(){},stopPropagation:function(){}})})},doRequest:function(g,c,h){var b;if(g.target.tagName=="A"){b=$(g.target)}else{b=$(g.target).getParent("A")}var f=b.getChildren("i").getLast();if(h==undefined){var h=b.getAttribute("data-id")}var a=$$("input:checked[name=currentimagetype]")[0];f.addClass("loading");var e="";if(b.hasClass("btn-primary")){e="btn-primary";b.removeClass(e);b.addClass("btn-info")}var d=new Request.JSON({url:c,method:"POST",data:h,onComplete:function(i){if(i!==undefined){$(document.body).fireEvent("updatecart",{target:null,cart:i,stop:function(){},preventDefault:function(){},stopPropagation:function(){}})}f.removeClass("loading");if(e.length>0){b.removeClass("btn-info");b.addClass("btn-success");setTimeout(function(){b.removeClass("btn-success");b.addClass(e)}.bind(this),2000)}}.bind(this)}).send();g.stopPropagation();g.preventDefault();return true}});window.addEvent("domready",function(){$(document.body).addEvent("click:relay(a.social-share-button-close)",function(c){c.preventDefault();var b=$(c.target).getParent(".social-sharing-toolbox");var a=new Fx.Tween(b,{property:"opacity",onComplete:function(){b.dispose()}});a.start(0)});$(document.body).addEvent("click:relay(a.social-share-button-open)",function(g){g.preventDefault();var f=$(g.target);if(!f.getAttribute("data-link")){f=f.getParent("a")}var i="id_"+Math.ceil(Math.random()*10000000);var d=$(g.target).getPosition();var b=new Element("div",{href:"#","class":"social-sharing-toolbox",html:"Loading",id:i,styles:{opacity:"1 !important",position:"absolute",top:d.y-10,left:d.x-10,opacity:0}});$$("body")[0].grab(b);b.fade("in");b.set("load",{evalScripts:true});b.load(f.getAttribute("data-link"));var h=null;var a=function(){var e=new Fx.Tween(b,{property:"opacity",onComplete:function(){b.dispose()}});e.start(0);$$("body").removeEvent("click",c)};b.addEvent("mouseleave",function(){h=window.setTimeout(a,1000)}.bind(this));b.addEvent("mouseenter",function(){window.clearTimeout(h)}.bind(this));var c=function(j){if(j.target.id!=i&&$(j.target).getParent("#"+i)==null){a()}}.bind(this);$$("body").addEvent("click",c)})});var $defined=function(a){return(a!=undefined)};var JSGallery2=new Class({Implements:Options,options:{selectSpeed:200,fadeSpeed:250,pageSpeed:1000,prevHandle:null,nextHandle:null,countHandle:null,titleTarget:null,initialIndex:-1,maxOpacity:0.8,next_image:"next_image.png",prev_image:"prev_image.png",showSocialMediaButton:true,showCartButton:true,showCartConnector:false,cartConnectorLinkRel:"",activeClass:"thumbnail-active",loadingClass:"thumbnail-loading",lightboxRel:"lightbo2"},initialize:function(b,g,h,f){var a=h.getChildren("div");this.currentPageNumber=0;this.loadedImages=0;this.blockKeys=false;this.imagesPerFirstPage=a[0].getChildren("div.thumbnail").length;this.imagesPerPage=this.imagesPerFirstPage;if(a.length>1&&a[1].getChildren("div.thumbnail").length>0){this.imagesPerPage=a[1].getChildren("div.thumbnail").length}this.setOptions(f);this.thumbs=b;this.bigImage=g;this.pageContainer=h;this.convertThumbs();this.lastPage=Math.ceil((this.thumbs.length-this.imagesPerFirstPage)/this.imagesPerPage)+1;var e=document.location;var d=e.toString().split("#");this.initialIndex=0;if(d.length>0){var c=/(^\d\d*$)/;if(c.test(d[1])==true){this.initialIndex=d[1]}}this.createControls();this.gotoPage(0);if(this.options.initialIndex!=-1){this.unBlockKeys();this.selectByIndex(this.options.initialIndex)}else{if(this.initialIndex!=0){this.unBlockKeys();this.selectByIndex(this.initialIndex)}}this.loadNextImage()},createControls:function(){this.prevLink=new Element("a",{events:{click:this.prevImage.bind(this),mouseleave:this.mouseLeaveHandler.bind(this)},styles:{width:"63px",display:"block",top:"0px",position:"absolute",height:"100%",background:"url("+this.options.prev_image+") no-repeat 0 50%"},href:"#","class":"link"}).inject(this.bigImage.getParent());this.prevLink.addEvent("mouseover",function(a){this.focusControl(a,this.prevLink)}.bind(this));this.zoomLink=this.prevLink.clone().inject(this.prevLink,"after").set({events:{click:this.zoomImage.bind(this),mouseleave:this.mouseLeaveHandler.bind(this)},styles:{width:"80%",left:"70px","background-image":"url("+this.options.zoom_image+")","background-position":"50% 50%"},rel:this.options.lightboxRel});this.zoomLink.addEvent("mouseover",function(a){this.focusControl(a,this.zoomLink)}.bind(this));this.nextLink=this.prevLink.clone().inject(this.zoomLink,"after").set({events:{click:this.nextImage.bind(this),mouseleave:this.mouseLeaveHandler.bind(this)},styles:{right:"0px","background-image":"url("+this.options.next_image+")"}});this.prevLink.setStyle("left",0);this.nextLink.addEvent("mouseover",function(a){this.focusControl(a,this.nextLink)}.bind(this));if(this.options.showCartButton){this.add2cartLink=new Element("a",{href:"#","class":"eventgallery-add2cart button-add2cart btn btn-primary",html:'<i class="big"></i>',id:"ajax-add2cartbuttoncount",styles:{"font-size":"59px",right:"0px","z-index":999,position:"absolute",display:"block",right:"10px",top:"10px"}});this.add2cartLink.hide();this.bigImage.getParent().grab(this.add2cartLink);$(document.body).fireEvent("updatecartlinks")}if(this.options.showCartConnector){this.cartConnectorLink=new Element("a",{href:"#","class":"button-cart-connector",html:'<i class="big"></i>',id:"ajax-cartconnector",rel:this.options.cartConnectorLinkRel,styles:{"font-size":"59px",right:"0px","z-index":999,position:"absolute",display:"block",right:"10px",top:"10px"}});this.bigImage.getParent().grab(this.cartConnectorLink)}if(this.options.showSocialMediaButton){this.socialmediabutton=new Element("a",{href:"#",rel:"nofollow","class":"social-share-button social-share-button-open",html:'<i class="big"></i>',id:"ajax-social-media-button",styles:{"font-size":"59px",right:"0px","z-index":999,position:"absolute",display:"block",left:"10px",top:"10px",width:"40px"}});this.bigImage.getParent().grab(this.socialmediabutton)}this.bigImage.addEvents({mousemove:this.mouseOverHandler.bind(this),mouseleave:this.mouseLeaveHandler.bind(this)});document.addEvent("keydown",this.keyboardHandler.bind(this));this.mouseLeaveHandler()},focusControl:function(a,b){b.setStyle("opacity",1)},mouseOverHandler:function(b){var a=this.thumbs.indexOf(this.selectedContainer);var d=this.bigImage.getSize().x;var c=0;if(a<this.thumbs.length-1){c=this.options.maxOpacity-this.getDistanceToMouse(this.nextLink,b)/d}this.nextLink.setStyle("opacity",c);c=0;if(a>0){c=this.options.maxOpacity-this.getDistanceToMouse(this.prevLink,b)/d}this.prevLink.setStyle("opacity",c);c=0;c=this.options.maxOpacity-this.getDistanceToMouse(this.zoomLink,b)/d*2;c=1;this.zoomLink.setStyle("opacity",c)},mouseLeaveHandler:function(){this.nextLink.setStyle("opacity",0);this.prevLink.setStyle("opacity",0);this.zoomLink.setStyle("opacity",0)},keyboardHandler:function(a){if(EventGalleryMediabox&&EventGalleryMediabox.isActive()&&eventGalleryMediaBoxImages&&eventGalleryMediaBoxImages[0][2]=="cart"){return}if(!this.blockKeys){if(a.code>=49&&a.code<=57){this.gotoPage(a.key-1)}else{if(a.key=="left"){this.prevImage(a)}else{if(a.key=="right"){this.nextImage(a)}}}}},getDistanceToMouse:function(a,d){var c=a.getSize();var e=Math.abs(d.client.x-(a.getLeft()+c.x/2));var b=Math.abs(d.client.y-(a.getTop()+c.y/2));return Math.sqrt(Math.pow(e,2)+Math.pow(b,2))},resetThumbs:function(){this.loadedImages=0;this.convertThumbs();this.loadNextImage();this.select(this.selectedContainer,true)},convertThumbs:function(){this.thumbs.each(function(b,a){this.convertThumb(b,a)},this)},convertThumb:function(b,a){if(!$defined(b)){return}b.addEvent("click",this.select.bind(this,b)).setStyle("position","relative").set("counter",a);b.getFirst().set("href","javascript: void(0);");b.addClass(this.options.loadingClass)},unBlockKeys:function(){this.blockKeys=false},select:function(b,g){g=typeof g!=="undefined"?g:false;if(this.blockKeys||!$defined(b)){return false}this.blockKeys=true;if($defined(this.selectedContainer)){if(b==this.selectedContainer&&!g){this.unBlockKeys();return false}this.deselect(this.selectedContainer)}var d=document.location;var c=d.toString().split("#");document.location.href=c[0]+"#"+this.thumbs.indexOf(b);var f=Math.floor((b.get("counter")-this.imagesPerFirstPage)/this.imagesPerPage)+1;if(this.currentPageNumber!=f){this.gotoPage(f,b)}this.selectedContainer=b;b.addClass(this.options.activeClass);var e=b.getFirst();if(this.options.showCartButton){this.add2cartLink.set("data-id",e.getAttribute("data-id"));$$(".eventgallery-add2cart").set("data-id",e.getAttribute("data-id"))}if(this.options.showCartConnector){this.cartConnectorLink.set("data-folder",e.getAttribute("data-folder"));this.cartConnectorLink.set("data-file",e.getAttribute("data-file"));this.cartConnectorLink.set("href",decodeURIComponent(e.getAttribute("data-cart-connector-link")))}if(this.options.showSocialMediaButton){this.socialmediabutton.set("data-link",decodeURIComponent(e.getAttribute("data-social-sharing-link")))}$(document.body).fireEvent("updatecartlinks");var a=e.longdesc;if(a==undefined){a=e.getAttribute("longDesc")}this.setImage(e.get("rel"),a,e.getAttribute("data-description"),e.getAttribute("data-title"))},loadNextImage:function(){if(!window.opera){var b=this.thumbs[this.loadedImages].getFirst();var a=b.get("rel");new Asset.image(a,{onload:this.imageLoaded.bind(this,this.thumbs[this.loadedImages])})}},imageLoaded:function(a){this.loadedImages++;a.removeClass(this.options.loadingClass);if(this.loadedImages<this.thumbs.length){this.loadNextImage()}},selectByIndex:function(a){if(a<0||this.thumbs.length<=a){a=0}this.select(this.thumbs[a])},deselect:function(a){a.removeClass(this.options.activeClass)},setImage:function(a,b,c,d){if(this.effect===undefined){this.effect=new Fx.Tween(this.bigImage,{duration:this.options.fadeSpeed,transition:Fx.Transitions.Quad.easeOut})}else{this.effect.cancel()}this.effect.start("opacity",0).chain(function(){this.bigImage.set("src",a);this.zoomLink.set("data-title",decodeURIComponent(d));this.zoomLink.set("href",b);EventGalleryMediabox.scanPage();try{if(eventGalleryMediaBoxImages&&eventGalleryMediaBoxChangeImage){eventGalleryMediaBoxImages[0][0]=this.zoomLink.get("href");eventGalleryMediaBoxImages[0][1]=this.zoomLink.getAttribute("data-title");eventGalleryMediaBoxChangeImage(0)}}catch(f){}if($defined($(this.options.titleTarget))){$(this.options.titleTarget).set("html",decodeURIComponent(c))}this.effect.start("opacity",1).chain(this.unBlockKeys.bind(this));try{pageTracker._trackPageview()}catch(f){}}.bind(this))},prevPage:function(){this.gotoPage(this.currentPageNumber-1)},nextPage:function(){this.gotoPage(this.currentPageNumber+1)},prevImage:function(a){a.stop();this.selectByIndex(this.thumbs.indexOf(this.selectedContainer)-1)},nextImage:function(a){a.stop();this.selectByIndex(this.thumbs.indexOf(this.selectedContainer)+1)},zoomImage:function(a){a.stop()},gotoPage:function(a,c){if(a==0){c=[c,this.thumbs[0]].pick()}else{c=[c,this.thumbs[(a-1)*this.imagesPerPage+this.imagesPerFirstPage]].pick()}if(a>=0&&a<this.lastPage){this.pageContainer.set("tween",{duration:this.options.pageSpeed,transition:Fx.Transitions.Quint.easeInOut});this.pageContainer.tween("margin-left",this.pageContainer.getLast().getSize().x*a*-1);var b=0;$(this.pageContainer).getChildren().each(function(e){var d=e.getSize().y;if(d>b){b=d}});this.pageContainer.setStyle("height",b);this.currentPageNumber=a;this.select(c);this.updateHandles()}},updateHandles:function(){if($defined(this.options.prevHandle)){new Fx.Tween(this.options.prevHandle,{link:"link",duration:this.options.fadeSpeed*2}).start("opacity",this.currentPageNumber==0?0:1)}if($defined(this.options.nextHandle)){new Fx.Tween(this.options.nextHandle,{link:"cancel",duration:this.options.fadeSpeed*2}).start("opacity",this.currentPageNumber==this.lastPage-1?0:1)}if($defined(this.options.countHandle)){this.updatePagingBar(this.options.countHandle,this.currentPageNumber,this.lastPage)}},updatePagingBar:function(a,f,c){if(a.innerHTML==""){for(var e=0;e<c;e++){this.createCountLink(this,a,e)}}var j=this.options.pageSpeed;if(c>9){for(var e=0;e<c;e++){$("count"+e).setStyle("display","inline")}var b=c;var h=0;var d=c-f-1;var g=f;if(g>4&&d>4){h=f-4;b=f+5}else{if(g<=4){h=0;b=f+5+(4-g)}if(d<=4){h=f-4-(4-d);b=c}}for(var e=0;e<h;e++){$("count"+e).setStyle("display","none")}for(var e=b;e<c;e++){$("count"+e).setStyle("display","none")}}a.getChildren(".active").removeClass("active");$("count"+f).addClass("active")},createCountLink:function(a,d,c){var e=new Element("a",{href:"#",html:c+1});e.addEvent("click",function(f){this.gotoPage(c);return false}.bind(a));var b=new Element("li",{"class":"count",id:"count"+c});d.grab(b.grab(e))}});var LazyLoadEventgallery=new Class({Implements:[Options,Events],options:{range:200,image:"blank.gif",resetDimensions:false,elements:"img",container:window,fireScroll:true,mode:"vertical",startPosition:0},initialize:function(a){this.setOptions(a);this.container=document.id(this.options.container);this.elements=$$(this.options.elements);var b=(this.options.mode=="vertical"?"y":"x");this.containerDimension=this.container.getSize()[b];this.startPosition=0;var d=(this.container!=window&&this.container!=document.body?this.container:"");this.elements.each(function(e){if(e.getAttribute("longDesc")){e.setStyle("opacity",0)}},this);this.elements=this.elements.filter(function(f){var e=f.getPosition(d)[b];if(f.getAttribute("longDesc")){if(e>this.containerDimension+this.options.range){if(this.options.resetDimensions){f.store("oWidth",f.get("width")).store("oHeight",f.get("height")).set({width:"",height:""})}return true}else{f.setStyle("background-image",'url("'+f.getAttribute("longDesc")+'")');this.fireEvent("load",[f])}}},this);var c=function(){var e=this.container.getScroll()[b];if(e>this.startPosition){this.elements=this.elements.filter(function(f){if((e+this.options.range+this.containerDimension)>=f.getPosition(d)[b]){if(f.getAttribute("longDesc")){f.setStyle("background-image",'url("'+f.getAttribute("longDesc")+'")')}if(this.options.resetDimensions){f.set({width:f.retrieve("oWidth"),height:f.retrieve("oHeight")})}this.fireEvent("load",[f]);return false}return true},this);this.startPosition=e}this.fireEvent("scroll");if(!this.elements.length){this.container.removeEvent("scroll",c);this.fireEvent("complete")}}.bind(this);window.addEvent("scroll",c);if(this.options.fireScroll){c()}}});var MooSwipe=MooSwipe||new Class({Implements:[Options,Events],options:{tolerance:20,preventDefaults:true},element:null,startX:null,isMoving:false,initialize:function(b,a){this.setOptions(a);this.element=$(b);this.element.addEvent("touchstart",this.onTouchStart.bind(this))},cancelTouch:function(){this.element.removeEvent("touchmove",this.onTouchMove);this.startX=null;this.isMoving=false},onTouchMove:function(c){this.options.preventDefaults&&c.preventDefault();if(this.isMoving){var a=c.touches[0].pageX;var b=this.startX-a;if(Math.abs(b)>=this.options.tolerance){this.cancelTouch();this.fireEvent(b>0?"swipeLeft":"swipeRight");this.fireEvent("swipe",b>0?"left":"right")}}},onTouchStart:function(a){this.options.preventDefaults&&a.preventDefault();if(a.touches.length==1){this.startX=a.touches[0].pageX;this.isMoving=true;this.element.addEvent("touchmove",this.onTouchMove.bind(this))}}});var eventGalleryMediaBoxImages=null;var eventGalleryMediaBoxChangeImage=null;var EventGalleryMediabox;(function(){var G,D,i,T,L,S,p,J,m,o,l,N,B,v,C=new Image(),Z=new Image(),t=false,z=false,W,b,k,c,Y,I,Q,X,aa,f,H,U,K,A,E,q,j="none",g,d="mediaBox",F,n;window.addEvent("domready",function(){document.id(document.body).adopt($$([W=new Element("div",{id:"mbOverlay"}).addEvent("click",R),b=new Element("div",{id:"mbCenter"})]).setStyle("display","none"));k=new Element("div",{id:"mbImage"}).inject(b);k.addEvent("click",h);c=new Element("div",{id:"mbBottom"}).inject(b).adopt(closeLink=new Element("a",{id:"mbCloseLink",href:"#"}).addEvent("click",R),f=new Element("a",{id:"mbNextLink",href:"#"}).addEvent("click",h),X=new Element("a",{id:"mbPrevLink",href:"#"}).addEvent("click",O),I=new Element("div",{id:"mbTitle"}),aa=new Element("div",{id:"mbNumber"}),Q=new Element("div",{id:"mbCaption"}));new MooSwipe("mbImage",{onSwipeLeft:h,onSwipeRight:O});B={overlay:new Fx.Tween(W,{property:"opacity",duration:360}).set(0),image:new Fx.Tween(k,{property:"opacity",duration:360,onComplete:M}),bottom:new Fx.Tween(c,{property:"opacity",duration:240}).set(0)}});EventGalleryMediabox={getRelation:function(){},isActive:function(){return b.getStyle("display")!="none"},close:function(){R()},open:function(ad,ac,ab){D=Object.append({text:["<big>&laquo;</big>","<big>&raquo;</big>","<big>&times;</big>"],loop:false,keyboard:true,alpha:true,stopKey:true,preventScrolling:true,overlayOpacity:0.7,resizeOpening:true,resizeDuration:240,resizeTransition:false,initialWidth:320,initialHeight:180,defaultWidth:640,defaultHeight:360,showCaption:true,showCounter:true,counterText:"({x} of {y})",imgBackground:false,imgPadding:100,imgPaddingFullscreen:10,showFullscreen:false,overflow:"auto",html5:"true",scriptaccess:"true",fullscreen:"true",fullscreenNum:"1",autoplay:"true",autoplayNum:"1",autoplayYes:"yes",volume:"100",medialoop:"true",bgcolor:"#000000",wmode:"opaque",useNB:true,playerpath:"/js/NonverBlaster.swf",controlColor:"0xFFFFFF",controlBackColor:"0x000000",showTimecode:"false",JWplayerpath:"/js/player.swf",backcolor:"000000",frontcolor:"999999",lightcolor:"000000",screencolor:"000000",controlbar:"over",controller:"true",flInfo:"true",revverID:"187866",revverFullscreen:"true",revverBack:"000000",revverFront:"ffffff",revverGrad:"000000",usViewers:"true",ytBorder:"0",ytColor1:"000000",ytColor2:"333333",ytQuality:"&ap=%2526fmt%3D18",ytRel:"0",ytInfo:"1",ytSearch:"0",vuPlayer:"basic",vmTitle:"1",vmByline:"1",vmPortrait:"1",vmColor:"ffffff"},ab||{});if(ad[ac][2]!=null&&ad[ac][2].indexOf("fullscreen")!=-1){D.showFullscreen=true}X.set("html",D.text[0]);f.set("html",D.text[1]);closeLink.set("html",D.text[2]);n=b.getStyle("padding-left").toInt()+k.getStyle("margin-left").toInt()+k.getStyle("padding-left").toInt();if((Browser.firefox)&&(Browser.Engine)&&(Browser.Engine.version<2)){t=true;D.overlayOpacity=1;W.className="mbOverlayFF"}if((Browser.ie)&&(Browser.version<5)){z=true;W.className="mbOverlayIE";W.setStyle("position","absolute");P()}if(D.showFullscreen){W.addClass("fullscreen")}else{W.removeClass("fullscreen")}if(typeof ad=="string"){ad=[[ad,ac,ab]];ac=0}var ae=function(af){af.preventDefault()};if(D.preventScrolling){W.addEvent("mousewheel",ae).addEvent("touchmove",ae);b.addEvent("mousewheel",ae).addEvent("touchmove",ae)}else{W.removeEvent("mousewheel",ae).removeEvent("touchmove",ae);b.removeEvent("mousewheel",ae).removeEvent("touchmove",ae)}i=ad;eventGalleryMediaBoxImages=i;eventGalleryMediaBoxChangeImage=a;D.loop=D.loop&&(i.length>1);s();u(true);e();B.overlay.start(D.showFullscreen?1:D.overlayOpacity);window.addEvent("resize",w);window.addEvent("scroll",w);return a(ac)}};Element.implement({eventGalleryMediabox:function(ab,ac){$$(this).eventGalleryMediabox(ab,ac);return this}});Elements.implement({eventGalleryMediabox:function(ab,ae,ad){ae=ae||function(af){A=af.getAttribute("rel").split(/[\[\]]/);A=A[1];var ah=$(af).getAttribute("data-title");if(!ah){ah=af.title}else{try{ah=decodeURIComponent(ah)}catch(ag){}}return[af.getAttribute("href"),ah,A]};ad=ad||function(){return true};var ac=this;ac.addEvent("contextmenu",function(af){});ac.removeEvents("click").addEvent("click",function(){var ag=ac.filter(ad,this);var ah=[];var af=[];ag.each(function(aj,ai){if(af.indexOf(aj.toString())<0){ah.include(ag[ai]);af.include(ag[ai].toString())}});return EventGalleryMediabox.open(ah.map(ae),af.indexOf(this.toString()),ab)});return ac}});function w(){window.clearTimeout(G);G=(function(){e();a(T)}).delay(500)}function e(){p=window.getScrollTop()+(window.getHeight()/2);m=window.getScrollLeft()+(window.getWidth()/2);B.resize=new Fx.Morph(b,Object.append({duration:D.resizeDuration,onComplete:V},D.resizeTransition?{transition:D.resizeTransition}:{}));b.setStyles({top:p,left:m,width:D.initialWidth,height:D.initialHeight,marginTop:-(D.initialHeight/2)-n,marginLeft:-(D.initialWidth/2)-n,display:""})}function P(){W.setStyles({top:window.getScrollTop(),left:window.getScrollLeft()})}function s(){l=window.getWidth();N=window.getHeight();W.setStyles({width:l,height:N})}function u(ab){if(Browser.firefox){["object",window.ie?"select":"embed"].forEach(function(ad){Array.forEach(document.getElementsByTagName(ad),function(ae){if(ab){ae._mediabox=ae.style.visibility}ae.style.visibility=ab?"hidden":ae._mediabox})})}W.style.display=ab?"":"none";var ac=ab?"addEvent":"removeEvent";if(z){window[ac]("scroll",P)}window[ac]("resize",s);if(D.keyboard){document[ac]("keydown",x)}}function x(ab){if(D.alpha){switch(ab.code){case 8:case 27:case 88:case 67:R();break;case 37:case 80:O();break;case 39:case 78:h()}}else{switch(ab.code){case 8:case 27:R();break;case 37:O();break;case 39:h()}}if(D.stopKey){return false}}function O(){return a(L)}function h(){return a(S)}function a(ab){if(ab>=0){k.set("html","");T=ab;L=((T||!D.loop)?T:i.length)-1;S=T+1;if(S==i.length){S=D.loop?0:-1}y();b.className="mbLoading";if(!i[ab][2]){i[ab][2]=""}U=i[ab][2].split(" ");K=U.length;if(K>1){E=(U[K-2].match("%"))?(window.getWidth()*((U[K-2].replace("%",""))*0.01))+"px":U[K-2]+"px";q=(U[K-1].match("%"))?(window.getHeight()*((U[K-1].replace("%",""))*0.01))+"px":U[K-1]+"px"}else{E="";q=""}H=i[ab][0];H=H.replace("(","%28").replace(")","%29");Y=i[T][1].split("::");if(H.match(/quietube\.com/i)){g=H.split("v.php/");H=g[1]}else{if(H.match(/\/\/yfrog/i)){j=(H.substring(H.length-1));if(j.match(/b|g|j|p|t/i)){j="image"}if(j=="s"){j="flash"}if(j.match(/f|z/i)){j="video"}H=H+":iphone"}else{if(H.match(/\#mb_/i)){j="inline";E=E||D.defaultWidth;q=q||D.defaultHeight;URLsplit=H.split("#");v=document.id(URLsplit[1]).get("html");r()}else{if(H.match(/\.gif|\.jpg|\.jpeg|\.png|twitpic\.com/i)||j=="image"){j="img";H=H.replace(/twitpic\.com/i,"twitpic.com/show/full");v=new Image();v.onload=r;v.src=H}else{if(H.match(/\.flv|\.mp4/i)||j=="video"){j="obj";E=E||D.defaultWidth;q=q||D.defaultHeight;if(D.useNB){v=new Swiff(""+D.playerpath+"?mediaURL="+H+"&allowSmoothing=true&autoPlay="+D.autoplay+"&buffer=6&showTimecode="+D.showTimecode+"&loop="+D.medialoop+"&controlColor="+D.controlColor+"&controlBackColor="+D.controlBackColor+"&defaultVolume="+D.volume+"&scaleIfFullScreen=true&showScalingButton=true&crop=false",{id:"MediaboxSWF",width:E,height:q,params:{wmode:D.wmode,bgcolor:D.bgcolor,allowscriptaccess:D.scriptaccess,allowfullscreen:D.fullscreen}})}else{v=new Swiff(""+D.JWplayerpath+"?file="+H+"&backcolor="+D.backcolor+"&frontcolor="+D.frontcolor+"&lightcolor="+D.lightcolor+"&screencolor="+D.screencolor+"&autostart="+D.autoplay+"&controlbar="+D.controlbar,{id:"MediaboxSWF",width:E,height:q,params:{wmode:D.wmode,bgcolor:D.bgcolor,allowscriptaccess:D.scriptaccess,allowfullscreen:D.fullscreen}})}r()}else{if(H.match(/\.mp3|\.aac|tweetmic\.com|tmic\.fm/i)||j=="audio"){j="obj";E=E||D.defaultWidth;q=q||"20px";if(H.match(/tweetmic\.com|tmic\.fm/i)){H=H.split("/");H[4]=H[4]||H[3];H="http://media4.fjarnet.net/tweet/tweetmicapp-"+H[4]+".mp3"}if(D.useNB){v=new Swiff(""+D.playerpath+"?mediaURL="+H+"&allowSmoothing=true&autoPlay="+D.autoplay+"&buffer=6&showTimecode="+D.showTimecode+"&loop="+D.medialoop+"&controlColor="+D.controlColor+"&controlBackColor="+D.controlBackColor+"&defaultVolume="+D.volume+"&scaleIfFullScreen=true&showScalingButton=true&crop=false",{id:"MediaboxSWF",width:E,height:q,params:{wmode:D.wmode,bgcolor:D.bgcolor,allowscriptaccess:D.scriptaccess,allowfullscreen:D.fullscreen}})}else{v=new Swiff(""+D.JWplayerpath+"?file="+H+"&backcolor="+D.backcolor+"&frontcolor="+D.frontcolor+"&lightcolor="+D.lightcolor+"&screencolor="+D.screencolor+"&autostart="+D.autoplay,{id:"MediaboxSWF",width:E,height:q,params:{wmode:D.wmode,bgcolor:D.bgcolor,allowscriptaccess:D.scriptaccess,allowfullscreen:D.fullscreen}})}r()}else{if(H.match(/\.swf/i)||j=="flash"){j="obj";E=E||D.defaultWidth;q=q||D.defaultHeight;v=new Swiff(H,{id:"MediaboxSWF",width:E,height:q,params:{wmode:D.wmode,bgcolor:D.bgcolor,allowscriptaccess:D.scriptaccess,allowfullscreen:D.fullscreen}});r()}else{if(H.match(/\.mov|\.m4v|\.m4a|\.aiff|\.avi|\.caf|\.dv|\.mid|\.m3u|\.mp3|\.mp2|\.mp4|\.qtz/i)||j=="qt"){j="qt";E=E||D.defaultWidth;q=(parseInt(q)+16)+"px"||D.defaultHeight;v=new Quickie(H,{id:"MediaboxQT",width:E,height:q,container:"mbImage",attributes:{controller:D.controller,autoplay:D.autoplay,volume:D.volume,loop:D.medialoop,bgcolor:D.bgcolor}});r()}else{if(H.match(/blip\.tv/i)){j="obj";E=E||"640px";q=q||"390px";v=new Swiff(H,{src:H,width:E,height:q,params:{wmode:D.wmode,bgcolor:D.bgcolor,allowscriptaccess:D.scriptaccess,allowfullscreen:D.fullscreen}});r()}else{if(H.match(/break\.com/i)){j="obj";E=E||"464px";q=q||"376px";d=H.match(/\d{6}/g);v=new Swiff("http://embed.break.com/"+d,{width:E,height:q,params:{wmode:D.wmode,bgcolor:D.bgcolor,allowscriptaccess:D.scriptaccess,allowfullscreen:D.fullscreen}});r()}else{if(H.match(/dailymotion\.com/i)){j="obj";E=E||"480px";q=q||"381px";v=new Swiff(H,{id:d,width:E,height:q,params:{wmode:D.wmode,bgcolor:D.bgcolor,allowscriptaccess:D.scriptaccess,allowfullscreen:D.fullscreen}});r()}else{if(H.match(/facebook\.com/i)){j="obj";E=E||"320px";q=q||"240px";g=H.split("v=");g=g[1].split("&");d=g[0];v=new Swiff("http://www.facebook.com/v/"+d,{movie:"http://www.facebook.com/v/"+d,classid:"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000",width:E,height:q,params:{wmode:D.wmode,bgcolor:D.bgcolor,allowscriptaccess:D.scriptaccess,allowfullscreen:D.fullscreen}});r()}else{if(H.match(/flickr\.com/i)){j="obj";E=E||"500px";q=q||"375px";g=H.split("/");d=g[5];v=new Swiff("http://www.flickr.com/apps/video/stewart.swf",{id:d,classid:"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000",width:E,height:q,params:{flashvars:"photo_id="+d+"&amp;show_info_box="+D.flInfo,wmode:D.wmode,bgcolor:D.bgcolor,allowscriptaccess:D.scriptaccess,allowfullscreen:D.fullscreen}});r()}else{if(H.match(/gametrailers\.com/i)){j="obj";E=E||"480px";q=q||"392px";d=H.match(/\d{5}/g);v=new Swiff("http://www.gametrailers.com/remote_wrap.php?mid="+d,{id:d,width:E,height:q,params:{wmode:D.wmode,bgcolor:D.bgcolor,allowscriptaccess:D.scriptaccess,allowfullscreen:D.fullscreen}});r()}else{if(H.match(/google\.com\/videoplay/i)){j="obj";E=E||"400px";q=q||"326px";g=H.split("=");d=g[1];v=new Swiff("http://video.google.com/googleplayer.swf?docId="+d+"&autoplay="+D.autoplayNum,{id:d,width:E,height:q,params:{wmode:D.wmode,bgcolor:D.bgcolor,allowscriptaccess:D.scriptaccess,allowfullscreen:D.fullscreen}});r()}else{if(H.match(/megavideo\.com/i)){j="obj";E=E||"640px";q=q||"360px";g=H.split("=");d=g[1];v=new Swiff("http://wwwstatic.megavideo.com/mv_player.swf?v="+d,{id:d,width:E,height:q,params:{wmode:D.wmode,bgcolor:D.bgcolor,allowscriptaccess:D.scriptaccess,allowfullscreen:D.fullscreen}});r()}else{if(H.match(/metacafe\.com\/watch/i)){j="obj";E=E||"400px";q=q||"345px";g=H.split("/");d=g[4];v=new Swiff("http://www.metacafe.com/fplayer/"+d+"/.swf?playerVars=autoPlay="+D.autoplayYes,{id:d,width:E,height:q,params:{wmode:D.wmode,bgcolor:D.bgcolor,allowscriptaccess:D.scriptaccess,allowfullscreen:D.fullscreen}});r()}else{if(H.match(/vids\.myspace\.com/i)){j="obj";E=E||"425px";q=q||"360px";v=new Swiff(H,{id:d,width:E,height:q,params:{wmode:D.wmode,bgcolor:D.bgcolor,allowscriptaccess:D.scriptaccess,allowfullscreen:D.fullscreen}});r()}else{if(H.match(/revver\.com/i)){j="obj";E=E||"480px";q=q||"392px";g=H.split("/");d=g[4];v=new Swiff("http://flash.revver.com/player/1.0/player.swf?mediaId="+d+"&affiliateId="+D.revverID+"&allowFullScreen="+D.revverFullscreen+"&autoStart="+D.autoplay+"&backColor=#"+D.revverBack+"&frontColor=#"+D.revverFront+"&gradColor=#"+D.revverGrad+"&shareUrl=revver",{id:d,width:E,height:q,params:{wmode:D.wmode,bgcolor:D.bgcolor,allowscriptaccess:D.scriptaccess,allowfullscreen:D.fullscreen}});r()}else{if(H.match(/rutube\.ru/i)){j="obj";E=E||"470px";q=q||"353px";g=H.split("=");d=g[1];v=new Swiff("http://video.rutube.ru/"+d,{movie:"http://video.rutube.ru/"+d,width:E,height:q,params:{wmode:D.wmode,bgcolor:D.bgcolor,allowscriptaccess:D.scriptaccess,allowfullscreen:D.fullscreen}});r()}else{if(H.match(/seesmic\.com/i)){j="obj";E=E||"435px";q=q||"355px";g=H.split("/");d=g[5];v=new Swiff("http://seesmic.com/Standalone.swf?video="+d,{id:d,width:E,height:q,params:{wmode:D.wmode,bgcolor:D.bgcolor,allowscriptaccess:D.scriptaccess,allowfullscreen:D.fullscreen}});r()}else{if(H.match(/tudou\.com/i)){j="obj";E=E||"400px";q=q||"340px";g=H.split("/");d=g[5];v=new Swiff("http://www.tudou.com/v/"+d,{width:E,height:q,params:{wmode:D.wmode,bgcolor:D.bgcolor,allowscriptaccess:D.scriptaccess,allowfullscreen:D.fullscreen}});r()}else{if(H.match(/twitcam\.com/i)){j="obj";E=E||"320px";q=q||"265px";g=H.split("/");d=g[3];v=new Swiff("http://static.livestream.com/chromelessPlayer/wrappers/TwitcamPlayer.swf?hash="+d,{width:E,height:q,params:{wmode:D.wmode,bgcolor:D.bgcolor,allowscriptaccess:D.scriptaccess,allowfullscreen:D.fullscreen}});r()}else{if(H.match(/twiturm\.com/i)){j="obj";E=E||"402px";q=q||"48px";g=H.split("/");d=g[3];v=new Swiff("http://twiturm.com/flash/twiturm_mp3.swf?playerID=0&sf="+d,{width:E,height:q,params:{wmode:D.wmode,bgcolor:D.bgcolor,allowscriptaccess:D.scriptaccess,allowfullscreen:D.fullscreen}});r()}else{if(H.match(/twitvid\.com/i)){j="obj";E=E||"600px";q=q||"338px";g=H.split("/");d=g[3];v=new Swiff("http://www.twitvid.com/player/"+d,{width:E,height:q,params:{wmode:D.wmode,bgcolor:D.bgcolor,allowscriptaccess:D.scriptaccess,allowfullscreen:D.fullscreen}});r()}else{if(H.match(/ustream\.tv/i)){j="obj";E=E||"400px";q=q||"326px";v=new Swiff(H+"&amp;viewcount="+D.usViewers+"&amp;autoplay="+D.autoplay,{width:E,height:q,params:{wmode:D.wmode,bgcolor:D.bgcolor,allowscriptaccess:D.scriptaccess,allowfullscreen:D.fullscreen}});r()}else{if(H.match(/youku\.com/i)){j="obj";E=E||"480px";q=q||"400px";g=H.split("id_");d=g[1];v=new Swiff("http://player.youku.com/player.php/sid/"+d+"=/v.swf",{width:E,height:q,params:{wmode:D.wmode,bgcolor:D.bgcolor,allowscriptaccess:D.scriptaccess,allowfullscreen:D.fullscreen}});r()}else{if(H.match(/youtube\.com\/watch/i)){g=H.split("v=");if(D.html5){j="url";E=E||"640px";q=q||"385px";d="mediaId_"+new Date().getTime();v=new Element("iframe",{src:"http://www.youtube.com/embed/"+g[1],id:d,width:E,height:q,frameborder:0});r()}else{j="obj";d=g[1];if(d.match(/fmt=22/i)){F="&ap=%2526fmt%3D22";E=E||"640px";q=q||"385px"}else{if(d.match(/fmt=18/i)){F="&ap=%2526fmt%3D18";E=E||"560px";q=q||"345px"}else{F=D.ytQuality;E=E||"480px";q=q||"295px"}}v=new Swiff("http://www.youtube.com/v/"+d+"&autoplay="+D.autoplayNum+"&fs="+D.fullscreenNum+F+"&border="+D.ytBorder+"&color1=0x"+D.ytColor1+"&color2=0x"+D.ytColor2+"&rel="+D.ytRel+"&showinfo="+D.ytInfo+"&showsearch="+D.ytSearch,{id:d,width:E,height:q,params:{wmode:D.wmode,bgcolor:D.bgcolor,allowscriptaccess:D.scriptaccess,allowfullscreen:D.fullscreen}});r()}}else{if(H.match(/youtube\.com\/view/i)){j="obj";g=H.split("p=");d=g[1];E=E||"480px";q=q||"385px";v=new Swiff("http://www.youtube.com/p/"+d+"&autoplay="+D.autoplayNum+"&fs="+D.fullscreenNum+F+"&border="+D.ytBorder+"&color1=0x"+D.ytColor1+"&color2=0x"+D.ytColor2+"&rel="+D.ytRel+"&showinfo="+D.ytInfo+"&showsearch="+D.ytSearch,{id:d,width:E,height:q,params:{wmode:D.wmode,bgcolor:D.bgcolor,allowscriptaccess:D.scriptaccess,allowfullscreen:D.fullscreen}});r()}else{if(H.match(/veoh\.com/i)){j="obj";E=E||"410px";q=q||"341px";H=H.replace("%3D","/");g=H.split("watch/");d=g[1];v=new Swiff("http://www.veoh.com/static/swf/webplayer/WebPlayer.swf?version=AFrontend.5.5.2.1001&permalinkId="+d+"&player=videodetailsembedded&videoAutoPlay="+D.AutoplayNum+"&id=anonymous",{id:d,width:E,height:q,params:{wmode:D.wmode,bgcolor:D.bgcolor,allowscriptaccess:D.scriptaccess,allowfullscreen:D.fullscreen}});r()}else{if(H.match(/viddler\.com/i)){j="obj";E=E||"437px";q=q||"370px";g=H.split("/");d=g[4];v=new Swiff(H,{id:"viddler_"+d,movie:H,classid:"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000",width:E,height:q,params:{wmode:D.wmode,bgcolor:D.bgcolor,allowscriptaccess:D.scriptaccess,allowfullscreen:D.fullscreen,id:"viddler_"+d,movie:H}});r()}else{if(H.match(/viddyou\.com/i)){j="obj";E=E||"416px";q=q||"312px";g=H.split("=");d=g[1];v=new Swiff("http://www.viddyou.com/get/v2_"+D.vuPlayer+"/"+d+".swf",{id:d,movie:"http://www.viddyou.com/get/v2_"+D.vuPlayer+"/"+d+".swf",width:E,height:q,params:{wmode:D.wmode,bgcolor:D.bgcolor,allowscriptaccess:D.scriptaccess,allowfullscreen:D.fullscreen}});r()}else{if(H.match(/vimeo\.com/i)){E=E||"640px";q=q||"360px";g=H.split("/");d=g[3];if(D.html5){j="url";d="mediaId_"+new Date().getTime();v=new Element("iframe",{src:"http://player.vimeo.com/video/"+g[3]+"?portrait="+D.vmPortrait,id:d,width:E,height:q,frameborder:0});r()}else{j="obj";v=new Swiff("http://www.vimeo.com/moogaloop.swf?clip_id="+d+"&amp;server=www.vimeo.com&amp;fullscreen="+D.fullscreenNum+"&amp;autoplay="+D.autoplayNum+"&amp;show_title="+D.vmTitle+"&amp;show_byline="+D.vmByline+"&amp;show_portrait="+D.vmPortrait+"&amp;color="+D.vmColor,{id:d,width:E,height:q,params:{wmode:D.wmode,bgcolor:D.bgcolor,allowscriptaccess:D.scriptaccess,allowfullscreen:D.fullscreen}});r()}}else{if(H.match(/12seconds\.tv/i)){j="obj";E=E||"430px";q=q||"360px";g=H.split("/");d=g[5];v=new Swiff("http://embed.12seconds.tv/players/remotePlayer.swf",{id:d,width:E,height:q,params:{flashvars:"vid="+d+"",wmode:D.wmode,bgcolor:D.bgcolor,allowscriptaccess:D.scriptaccess,allowfullscreen:D.fullscreen}});r()}else{j="url";E=E||D.defaultWidth;q=q||D.defaultHeight;d="mediaId_"+new Date().getTime();v=new Element("iframe",{src:H,id:d,width:E,height:q,frameborder:0});r()}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}return false}function r(){imgPadding=D.showFullscreen?D.imgPaddingFullscreen:D.imgPadding;if(j=="img"){k.setStyles({overflow:"hidden"});E=v.width;q=v.height;if(D.imgBackground){k.setStyles({backgroundImage:"url("+H+")",display:""})}else{if(q>=N-imgPadding&&(q/N)>=(E/l)){q=N-imgPadding;E=v.width=parseInt((q/v.height)*E);v.height=q}else{if(E>=l-imgPadding&&(q/N)<(E/l)){E=l-imgPadding;q=v.height=parseInt((E/v.width)*q);v.width=E}}if(Browser.ie){v=document.id(v)}k.setStyles({backgroundImage:"none",display:""});v.inject(k)}}else{if(j=="obj"){if(Browser.Plugins.Flash.version<8){k.setStyles({backgroundImage:"none",display:""});k.set("html",'<div id="mbError"><b>Error</b><br/>Adobe Flash is either not installed or not up to date, please visit <a href="http://www.adobe.com/shockwave/download/download.cgi?P1_Prod_Version=ShockwaveFlash" title="Get Flash" target="_new">Adobe.com</a> to download the free player.</div>');E=D.DefaultWidth;q=D.DefaultHeight}else{k.setStyles({backgroundImage:"none",display:""});v.inject(k)}}else{if(j=="qt"){k.setStyles({backgroundImage:"none",display:""});v}else{if(j=="inline"){if(D.overflow){k.setStyles({overflow:D.overflow})}k.setStyles({backgroundImage:"none",display:""});k.set("html",v);if(E>l){E=l.margin}}else{if(j=="url"){k.setStyles({backgroundImage:"none",display:""});v.inject(k)}else{k.setStyles({backgroundImage:"none",display:""});k.set("html",'<div id="mbError"><b>Error</b><br/>A file type error has occoured, please visit <a href="iaian7.com/webcode/mediaboxAdvanced" title="mediaboxAdvanced" target="_new">iaian7.com</a> or contact the website author for more information.</div>');E=D.defaultWidth;q=D.defaultHeight}}}}}k.setStyles({width:E,height:q});Q.setStyles({width:E});I.set("html",(D.showCaption)?Y[0]:"");Q.set("html",(D.showCaption&&(Y.length>1))?Y[1]:"");aa.set("html",(D.showCounter&&(i.length>1))?D.counterText.replace(/{x}/,T+1).replace(/{y}/,i.length):"");if((L>=0)&&(i[L][0].match(/\.gif|\.jpg|\.jpeg|\.png|twitpic\.com/i))){C.src=i[L][0].replace(/twitpic\.com/i,"twitpic.com/show/full")}if((S>=0)&&(i[S][0].match(/\.gif|\.jpg|\.jpeg|\.png|twitpic\.com/i))){Z.src=i[S][0].replace(/twitpic\.com/i,"twitpic.com/show/full")}c.setStyle("width",E);var ag=c.offsetHeight;c.setStyle("width","auto");origImageWidth=E;origImageHeight=q;E=k.offsetWidth;q=k.offsetHeight+ag;if(D.showFullscreen){var ad=window.getWidth()-c.getStyle("padding-left").toInt()-c.getStyle("padding-right").toInt();if(ad>1024){ad=1024}c.setStyle("width",ad);c.setStyle("margin","auto");Q.setStyle("width",ad);var ag=c.offsetHeight;q=N-imgPadding;if(typeof v=="object"){var ac=origImageWidth/origImageHeight;var ab=origImageHeight;var af=origImageWidth;if(af>l-(2*n)||ab>N-ag-(2*n)){ab=N-ag-(2*n);af=Math.floor(ab*ac);if(af>l-(2*n)){af=l-(2*n);ab=Math.floor(af/ac)}}v.setStyles({width:af,height:ab});v.setStyle("display","block");v.setStyle("margin","auto");var ae=Math.ceil((N-ag-(af/ac))/2-n);if(ae>0){v.setStyle("padding-top",ae)}}k.setStyle("width","auto");k.setStyle("height",N-ag-k.getStyle("padding-top").toInt()-k.getStyle("padding-top").toInt());E=l-1-b.getStyle("padding-left").toInt()-b.getStyle("padding-right").toInt();q=N-1-b.getStyle("padding-top").toInt()-b.getStyle("padding-bottom").toInt()}else{if(q>N&&v){q=N-imgPadding;k.setStyle("height",q-ag-(2*n));if(typeof v=="object"){var ac=origImageWidth/origImageHeight;v.width=((q-ag)*ac)-(2*n);v.setStyle("display","block");v.setStyle("margin","auto")}Q.setStyle("width",k.getStyle("width").toInt()-n);I.setStyle("width",k.getStyle("width").toInt()-n)}}if(q>=p+p){J=-p}else{J=-(q/2)}if(E>=m+m){o=-m}else{o=-(E/2)}if(D.resizeOpening){B.resize.start({width:E,height:q,marginTop:J,marginLeft:o})}else{b.setStyles({width:E,height:q,marginTop:J,marginLeft:o});V()}}function V(){B.image.start(1)}function M(){b.className="";if(L>=0){X.style.display=""}if(S>=0){f.style.display=""}B.bottom.start(1)}function y(){if(v){v.onload=function(){}}B.resize.cancel();B.image.cancel().set(0);B.bottom.cancel().set(0);$$(X,f).setStyle("display","none")}function R(){if(T>=0){v.onload=function(){};k.set("html","");for(var ab in B){B[ab].cancel()}b.setStyle("display","none");B.overlay.chain(u).start(0)}window.removeEvent("resize",w);window.removeEvent("scroll",w);return false}})();EventGalleryMediabox.scanPage=function(){var b=$$("button");var c=$$("a");c.combine(b);var a=c.filter(function(d){if(d.tagName=="BUTTON"&&d.getAttribute("data-rel")&&d.getAttribute("data-href")){d.setAttribute("rel",d.getAttribute("data-rel"));d.setAttribute("href",d.getAttribute("data-href"))}return d.getAttribute("rel")&&d.getAttribute("rel").test(/^lightbo2/i)});$$(a).eventGalleryMediabox({},null,function(e){var d=this.getAttribute("rel").replace(/[[]|]/gi," ");var f=d.split(" ");return(this==e)||((this.getAttribute("rel").length>8)&&e.getAttribute("rel").match(f[1]))})};window.addEvent("domready",EventGalleryMediabox.scanPage);